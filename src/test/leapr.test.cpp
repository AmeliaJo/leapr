#define CATCH_CONFIG_MAIN
#include "catch.hpp"
#include "leapr.cpp"



TEST_CASE( "leapr" ){
  int nphon, ncold, lat;
  double sps, awr, aws, delta, twt, c, tbeta, dka;
  std::vector<double> alpha, beta, temp, rho, oscE, oscW, kappa,
                      ssmDiag(70), ssmChangeA(70), ssmChangeB(70);
  REQUIRE( true );

  GIVEN( "quickTest" ) {
    nphon = 100;
    awr   = 0.99917;  ncold = 0; 
    aws   = 15.85316; sps = 3.8883; 
    lat   = 0;            
    alpha = {.01008,   .033,     0.050406, 0.504060, 0.554466, 1.873790, 
             2.055660, 5.671180, 7.472890, 20.52030, 32.46250, 50.0};
    beta  = {0.000000, 0.006375, 0.038250, 0.06575, 0.564547, 1.77429,
             3.422470, 8.258620, 18.72180, 25.0};
    temp  = { 296.0 };                                          
    delta = 0.00255;                                           
    rho = {0, 0.0005, 0.001, 0.002, 0.0035, 0.005, 0.0075, 0.01, 0.013, 0.0165, 
           0.02, 0.0245, 0.029, 0.034, 0.0395, 0.045, 0.0506, 0.0562, 0.0622, 
           0.0686, 0.075, 0.083, 0.091, 0.099, 0.107, 0.115, 0.1197, 0.1214, 
           0.1218, 0.1195, 0.1125, 0.1065, 0.1005, 0.09542, 0.09126, 0.0871, 
           0.0839, 0.0807, 0.07798, 0.07574, 0.0735, 0.07162, 0.06974, 0.06804, 
           0.06652, 0.065, 0.0634, 0.0618, 0.06022, 0.05866, 0.0571, 0.05586, 
           0.05462, 0.0535, 0.0525, 0.0515, 0.05042, 0.04934, 0.04822, 0.04706, 
           0.0459, 0.04478, 0.04366, 0.04288, 0.04244, 0.042, 0.0, };
    twt    = 0.055556;   c = 0.0;   tbeta = 0.444444;
    oscE   = { 0.205,    0.48};                                 
    oscW   = { 0.166667, 0.333333 };                            
    dka = 0.0;

    leapr( nphon, awr, ncold, aws, lat, alpha, beta, temp, delta, rho, twt, c, tbeta, oscE, oscW, dka, kappa );
  
  } // GIVEN
} // TEST CASE


