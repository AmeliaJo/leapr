#define CATCH_CONFIG_MAIN
#include <iostream>
#include "../../catch.hpp"
#include "fccLatticeFactors.h"

void equal( double a, double b ){
  if (b == 0.0){ 
    REQUIRE( std::abs(b-a) < 1e-6 );
    return;
  }
  REQUIRE ( std::abs( (a-b)/(b) ) < 1e-6 );
}


TEST_CASE( "Function to Compute FCC Lattice Factors" ){
  int lat = 4, ifl = 1, nw = 60000;
  double w = 0, t2 = 3.5e-5, c1 = 1.5e15, wint = 0, ulim = 9.6e19, a = 2e-8, 
    twothd = 0.666666667, twopis = 39.5;
  std::vector<double> b (60000, 0.0);

  int imax = fccLatticeFactors( twothd, twopis, lat, b, ifl, w, nw, t2, c1, wint, ulim, a );
  REQUIRE( imax ==  29789 );

  std::vector<double> b_0_99 { 4.88812504E+19, 2.28848899E-9, 4.7163E+19, 
    2.32980337E-9, 4.55632504E+19, 2.37035085E-9, 4.4082E+19, 2.40984625E-9, 
    4.27192503E+19, 2.44798172E-9, 4.1475E+19, 2.48443010E-9, 4.03492503E+19, 
    2.51884966E-9, 3.9342E+19, 2.55089018E-9, 3.84532503E+19, 2.58020049E-9, 
    3.7683E+19, 2.60643708E-9, 3.70312503E+19, 2.62927368E-9, 3.6498E+19, 
    2.64841139E-9, 3.60832503E+19, 2.66358865E-9, 3.5787E+19, 2.67459072E-9, 
    3.56092503E+19, 2.68125776E-9, 3.5550E+19, 2.68349121E-9, 3.56092503E+19, 
    2.68125776E-9, 3.5787E+19, 2.67459072E-9, 3.60832503E+19, 2.66358865E-9, 
    3.6498E+19, 2.64841139E-9, 3.70312503E+19, 2.62927368E-9, 3.7683E+19, 
    2.60643708E-9, 3.84532503E+19, 2.58020049E-9, 3.9342E+19, 2.55089018E-9, 
    4.03492503E+19, 2.51884966E-9, 4.1475E+19, 2.48443010E-9, 4.27192503E+19, 
    2.44798172E-9, 4.4082E+19, 2.40984625E-9, 4.55632504E+19, 2.37035085E-9, 
    4.7163E+19, 2.32980337E-9, 4.88812504E+19, 2.28848899E-9, 4.7163E+19, 
    2.32980337E-9, 4.54052504E+19, 2.37447141E-9, 4.3766E+19, 2.41853041E-9, 
    4.22452503E+19, 2.46167683E-9, 4.0843E+19, 2.50357821E-9, 3.95592503E+19, 
    2.54387610E-9, 3.8394E+19, 2.58219062E-9, 3.73472503E+19, 2.61812673E-9, 
    3.6419E+19, 2.65128229E-9, 3.56092503E+19, 2.68125776E-9, 3.4918E+19, 
    2.70766730E-9, 3.43452503E+19, 2.73015082E-9, 3.3891E+19, 2.74838638E-9, 
    3.35552503E+19, 2.76210218E-9, 3.3338E+19, 2.77108730E-9, 3.32392503E+19, 
    2.77520054E-9, 3.3259E+19, 2.77437643E-9, 3.33972503E+19, 2.76862812E-9, 
    3.3654E+19, 2.75804682E-9 };
  
  for ( auto i = 0; i < 100; ++i ){ 
    equal( b[i], b_0_99[i] ); 
  }

  std::vector<double> b_200_299 { 2.71073548E-9, 3.37132503E+19, 2.75562216E-9, 
    3.2706E+19, 2.79773299E-9, 3.18172502E+19, 2.83653835E-9, 3.1047E+19, 
    2.87150885E-9, 3.03952502E+19, 2.90213172E-9, 2.9862E+19, 2.92792895E-9, 
    2.94472502E+19, 2.94847608E-9, 2.9151E+19, 2.96342030E-9, 2.89732502E+19, 
    2.97249664E-9, 2.8914E+19, 2.97554068E-9, 2.89732502E+19, 2.97249664E-9, 
    2.9151E+19, 2.96342030E-9, 2.94472502E+19, 2.94847608E-9, 2.9862E+19, 
    2.92792895E-9, 3.03952502E+19, 2.90213172E-9, 3.1047E+19, 2.87150885E-9, 
    3.18172502E+19, 2.83653835E-9, 3.2706E+19, 2.79773299E-9, 3.37132503E+19, 
    2.75562216E-9, 3.4839E+19, 2.71073548E-9, 3.60832503E+19, 2.66358865E-9, 
    3.7446E+19, 2.61467228E-9, 3.89272503E+19, 2.56444340E-9, 4.0527E+19, 
    2.51331979E-9, 4.27192503E+19, 2.44798172E-9, 4.0843E+19, 2.50357821E-9, 
    3.90852503E+19, 2.55925484E-9, 3.7446E+19, 2.61467228E-9, 3.59252503E+19, 
    2.66943949E-9, 3.4523E+19, 2.72311333E-9, 3.32392503E+19, 2.77520054E-9, 
    3.2074E+19, 2.82516240E-9, 3.10272502E+19, 2.87242262E-9, 3.0099E+19, 
    2.91637889E-9, 2.92892502E+19, 2.95641811E-9, 2.8598E+19, 2.99193496E-9, 
    2.80252502E+19, 3.02235331E-9, 2.7571E+19, 3.04714921E-9, 2.72352502E+19, 
    3.06587396E-9, 2.7018E+19, 3.07817553E-9, 2.69192502E+19, 3.08381632E-9, 
    2.6939E+19, 3.08268568E-9, 2.70772502E+19, 3.07480588E-9, 2.7334E+19, 
    3.06033088E-9, 2.77092502E+19, 3.03953812E-9, 2.8203E+19, 3.01281404E-9, 
    2.88152502E+19, 2.98063491E-9, 2.9546E+19, 2.94354469E-9, 3.03952502E+19, 
    2.90213172E-9, 3.1363E+19, 2.85700619E-9 };

  for ( auto i = 0; i < 100; ++i ){ 
    equal( b[i+199], b_200_299[i] ); 
  }

  std::vector<double> b_800_899 { 3.72133276E-9, 1.94932501E+19, 3.62391376E-9, 
    2.0619E+19, 3.52359659E-9, 2.18632502E+19, 3.42186301E-9, 3.5787E+19, 
    2.67459072E-9, 3.35552503E+19, 2.76210218E-9, 3.1442E+19, 2.85341473E-9, 
    2.94472502E+19, 2.94847608E-9, 2.7571E+19, 3.04714921E-9, 2.58132502E+19, 
    3.14918835E-9, 2.4174E+19, 3.25421109E-9, 2.26532502E+19, 3.36166723E-9, 
    2.1251E+19, 3.47080564E-9, 1.99672501E+19, 3.58064159E-9, 1.8802E+19, 
    3.68992854E-9, 1.77552501E+19, 3.79713978E-9, 1.6827E+19, 3.90046722E-9, 
    1.60172501E+19, 3.99784547E-9, 1.5326E+19, 4.08700877E-9, 1.47532501E+19, 
    4.16558623E-9, 1.4299E+19, 4.23123501E-9, 1.39632501E+19, 4.28180341E-9, 
    1.3746E+19, 4.31550685E-9, 1.36472501E+19, 4.33109197E-9, 1.3667E+19, 
    4.32796144E-9, 1.38052501E+19, 4.30623615E-9, 1.4062E+19, 4.26674250E-9, 
    1.44372501E+19, 4.21092728E-9, 1.4931E+19, 4.14071684E-9, 1.55432501E+19, 
    4.05834594E-9, 1.6274E+19, 3.96618369E-9, 1.71232501E+19, 3.86657894E-9, 
    1.8091E+19, 3.76173929E-9, 1.91772501E+19, 3.65364893E-9, 2.0382E+19, 
    3.54402341E-9, 3.56092503E+19, 2.68125776E-9, 3.3338E+19, 2.77108730E-9, 
    3.11852502E+19, 2.86513681E-9, 2.9151E+19, 2.96342030E-9, 2.72352502E+19, 
    3.06587396E-9, 2.5438E+19, 3.17233102E-9, 2.37592502E+19, 3.28249155E-9, 
    2.2199E+19, 3.39588734E-9, 2.07572501E+19, 3.51184284E-9, 1.9434E+19, 
    3.62943381E-9, 1.82292501E+19, 3.74744769E-9, 1.7143E+19, 3.86435101E-9, 
    1.61752501E+19, 3.97827206E-9, 1.5326E+19, 4.08700877E-9, 1.45952501E+19, 
    4.18807269E-9, 1.3983E+19, 4.27877846E-9 };

  for ( auto i = 0; i < 100; ++i ){ 
    equal( b[i+799], b_800_899[i] ); 
  }

  std::vector<double> b_1000_1099 { 2.97554068E-9, 2.69192502E+19, 
    3.08381632E-9, 2.5043E+19, 3.19725153E-9, 2.32852502E+19, 3.31573282E-9, 
    2.1646E+19, 3.43899190E-9, 2.01252501E+19, 3.56655839E-9, 1.8723E+19, 
    3.69770501E-9, 1.74392501E+19, 3.83138750E-9, 1.6274E+19, 3.96618369E-9, 
    1.52272501E+19, 4.10023965E-9, 1.4299E+19, 4.23123501E-9, 1.34892501E+19, 
    4.35638324E-9, 1.2798E+19, 4.47248536E-9, 1.22252501E+19, 4.57605363E-9, 
    1.1771E+19, 4.66351417E-9, 1.14352501E+19, 4.73148152E-9, 1.1218E+19, 
    4.77707723E-9, 1.11192501E+19, 4.79824294E-9, 1.1139E+19, 4.79398729E-9, 
    1.12772501E+19, 4.76451146E-9, 1.1534E+19, 4.71118335E-9, 1.19092501E+19, 
    4.63636666E-9, 1.2403E+19, 4.54314511E-9, 1.30152501E+19, 4.43500101E-9, 
    1.3746E+19, 4.31550685E-9, 1.45952501E+19, 4.18807269E-9, 1.5563E+19, 
    4.05577003E-9, 1.66492501E+19, 3.92123294E-9, 3.5787E+19, 2.67459072E-9, 
    3.33972503E+19, 2.76862812E-9, 3.1126E+19, 2.86786249E-9, 2.89732502E+19, 
    2.97249664E-9, 2.6939E+19, 3.08268568E-9, 2.50232502E+19, 3.19851302E-9, 
    2.3226E+19, 3.31995937E-9, 2.15472502E+19, 3.44686326E-9, 1.9987E+19, 
    3.57887206E-9, 1.85452501E+19, 3.71538338E-9, 1.7222E+19, 3.85547763E-9, 
    1.60172501E+19, 3.99784547E-9, 1.4931E+19, 4.14071684E-9, 1.39632501E+19, 
    4.28180341E-9, 1.3114E+19, 4.41827141E-9, 1.23832501E+19, 4.54676659E-9, 
    1.1771E+19, 4.66351417E-9, 1.12772501E+19, 4.76451146E-9, 1.0902E+19, 
    4.84581568E-9, 1.06452500E+19, 4.90390499E-9, 1.0507E+19, 4.93606209E-9, 
    1.04872500E+19, 4.94070780E-9, 1.0586E+19 };


  for ( auto i = 0; i < 100; ++i ){ 
    equal( b[i+999], b_1000_1099[i] ); 
  }


  std::vector<double> b_10000_10099 { 3.82921981E-9, 1.66492501E+19, 
    3.92123294E-9, 1.5958E+19, 4.00526033E-9, 1.53852501E+19, 4.07913146E-9, 
    1.4931E+19, 4.14071684E-9, 1.45952501E+19, 4.18807269E-9, 1.4378E+19, 
    4.21959472E-9, 1.42792501E+19, 4.23416016E-9, 1.4299E+19, 4.23123501E-9, 
    1.44372501E+19, 4.21092728E-9, 1.4694E+19, 4.17397614E-9, 1.50692501E+19, 
    4.12167896E-9, 1.5563E+19, 4.05577003E-9, 1.61752501E+19, 3.97827206E-9, 
    1.6906E+19, 3.89134331E-9, 1.77552501E+19, 3.79713978E-9, 1.8723E+19, 
    3.69770501E-9, 1.98092501E+19, 3.59489296E-9, 2.1014E+19, 3.49032298E-9, 
    2.23372502E+19, 3.38536210E-9, 2.3779E+19, 3.28112810E-9, 2.53392502E+19, 
    3.17850648E-9, 2.7018E+19, 3.07817553E-9, 2.73932502E+19, 3.05701943E-9, 
    2.5596E+19, 3.16252472E-9, 2.39172502E+19, 3.27163133E-9, 2.2357E+19, 
    3.38386647E-9, 2.09152501E+19, 3.49855294E-9, 1.9592E+19, 3.61476937E-9, 
    1.83872501E+19, 3.73131221E-9, 1.7301E+19, 3.84666510E-9, 1.63332501E+19, 
    3.95898335E-9, 1.5484E+19, 4.06610322E-9, 1.47532501E+19, 4.16558623E-9, 
    1.4141E+19, 4.25480753E-9, 1.36472501E+19, 4.33109197E-9, 1.3272E+19, 
    4.39189343E-9, 1.30152501E+19, 4.43500101E-9, 1.2877E+19, 4.45874497E-9, 
    1.28572501E+19, 4.46216819E-9, 1.2956E+19, 4.44513045E-9, 1.31732501E+19, 
    4.40832407E-9, 1.3509E+19, 4.35319758E-9, 1.39632501E+19, 4.28180341E-9, 
    1.4536E+19, 4.19659948E-9, 1.52272501E+19, 4.10023965E-9, 1.6037E+19, 
    3.99538298E-9, 1.69652501E+19, 3.88454224E-9, 1.8012E+19, 3.76997969E-9, 
    1.91772501E+19, 3.65364893E-9, 2.0461E+19 };

  for ( auto i = 0; i < 100; ++i ){ 
    equal( b[i+9999], b_10000_10099[i] ); 
  }

  std::vector<double> b_50000_50099 { 4.43500101E-9, 1.3983E+19, 
    4.27877846E-9, 1.50692501E+19, 4.12167896E-9, 1.6274E+19, 3.96618369E-9, 
    1.75972501E+19, 3.81414833E-9, 1.9039E+19, 3.66689026E-9, 2.05992501E+19, 
    3.52528535E-9, 2.2278E+19, 3.38986092E-9, 2.40752502E+19, 3.26087820E-9, 
    2.5991E+19, 3.13840137E-9, 2.80252502E+19, 3.02235331E-9, 3.0178E+19, 
    2.91255914E-9, 3.24492503E+19, 2.80877951E-9, 3.4839E+19, 2.71073548E-9, 
    3.73472503E+19, 2.61812673E-9, 3.9974E+19, 2.53064470E-9, 4.27192503E+19, 
    2.44798172E-9, 1.1218E+19, 4.77707723E-9, 1.04872500E+19, 4.94070780E-9, 
    9.8750E+18, 5.09156659E-9, 9.38125008E+18, 5.22383710E-9, 9.0060E+18, 
    5.33155641E-9, 8.74925008E+18, 5.40921903E-9, 8.6110E+18, 5.45246876E-9, 
    8.59125008E+18, 5.45873236E-9, 8.6900E+18, 5.42762822E-9, 8.90725008E+18, 
    5.36102903E-9, 9.2430E+18, 5.26275926E-9, 9.69725009E+18, 5.13801874E-9, 
    1.0270E+19, 4.99269181E-9, 1.09612501E+19, 4.83270114E-9, 1.1771E+19, 
    4.66351417E-9, 1.26992501E+19, 4.48984082E-9, 1.3746E+19, 4.31550685E-9, 
    1.49112501E+19, 4.14345813E-9, 1.6195E+19, 3.97584554E-9, 1.75972501E+19, 
    3.81414833E-9, 1.9118E+19, 3.65930620E-9, 2.07572501E+19, 3.51184284E-9, 
    2.2515E+19, 3.37197235E-9, 2.43912502E+19, 3.23968624E-9, 2.6386E+19, 
    3.11482177E-9, 2.84992502E+19, 2.99711401E-9, 3.0731E+19, 2.88623463E-9, 
    3.30812503E+19, 2.78181999E-9, 3.5550E+19, 2.68349121E-9, 3.81372503E+19, 
    2.59086804E-9, 4.0843E+19, 2.50357821E-9, 1.06452500E+19, 4.90390499E-9, 
    9.8750E+18, 5.09156659E-9, 9.22325008E+18 };

  for ( auto i = 0; i < 100; ++i ){ 
    equal( b[i+49999], b_50000_50099[i] ); 
  }



  GIVEN( "inputs" ){
    THEN( "outputs" ){
      REQUIRE( true );

    } // THEN
  } // GIVEN
} // TEST CASE

